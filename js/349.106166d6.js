"use strict";(self["webpackChunksimple_twitter"]=self["webpackChunksimple_twitter"]||[]).push([[349],{2895:function(t,e,s){s.d(e,{Z:function(){return f}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"modal",class:{show:t.isShow}},[e("div",{staticClass:"modal_container mx-auto"},[e("div",{staticClass:"modal_container-header d-flex"},[e("div",{staticClass:"cancel-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.closeModal.apply(null,arguments)}}},[e("div",{staticClass:"link-icon",on:{click:function(e){return e.preventDefault(),t.back()}}}),e("i",{staticClass:"fa-solid fa-xmark size-32"})]),e("h5",[t._v("編輯個人資訊")]),e("button",{staticClass:"btn",attrs:{type:"submit",form:"profile-box",disabled:t.isProcessing}},[t._v("儲存")])]),e("form",{staticClass:"profile-box",attrs:{id:"profile-box"},on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.handleSubmit.apply(null,arguments)}}},[e("div",{staticClass:"user-banner"},[e("div",{staticClass:"filter"}),e("div",{staticClass:"icons"},[t._m(0),e("input",{staticClass:"banner-edit",attrs:{type:"file",id:"coverPhoto",accept:"image/*",name:"coverPhoto"},on:{change:t.handleFileChange}}),e("i",{staticClass:"icon-edit-done",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.defaultCover(t.currentUser.coverPhoto)}}})]),e("img",{attrs:{src:t._f("emptyBanner")(t.user.coverPhoto),alt:""}})]),e("div",{staticClass:"avatar"},[e("div",{staticClass:"filter"}),t._m(1),e("input",{staticClass:"avatar-edit",attrs:{type:"file",id:"avatar",accept:"image/*",name:"avatar"},on:{change:t.handleFileChange}}),e("img",{attrs:{src:t._f("emptyImage")(t.user.avatar),alt:""}})]),e("div",{staticClass:"user-name",class:{error:t.user.name.length>50}},[e("label",{attrs:{for:""}},[t._v("名稱")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.user.name,expression:"user.name"}],attrs:{type:"text",id:"name",name:"name",maxlength:"50",required:""},domProps:{value:t.user.name},on:{input:function(e){e.target.composing||t.$set(t.user,"name",e.target.value)}}})]),e("p",{staticClass:"input-length",class:{error:t.user.name.length>50}},[t._v(t._s(t.user.name.length)+"/50")]),e("div",{staticClass:"user-description",class:{error:t.user.introduction.length>160}},[e("label",{attrs:{for:"introduction"}},[t._v("自我介紹")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.user.introduction,expression:"user.introduction"}],attrs:{id:"introduction",name:"introduction",cols:"30",rows:"10",maxlength:"160",required:""},domProps:{value:t.user.introduction},on:{input:function(e){e.target.composing||t.$set(t.user,"introduction",e.target.value)}}})]),e("p",{staticClass:"input-length",class:{error:t.user.introduction.length>160}},[t._v(t._s(t.user.introduction.length||0)+"/160")])])])])},i=[function(){var t=this,e=t._self._c;return e("label",{attrs:{for:"coverPhoto"}},[e("img",{staticClass:"icon-photo",attrs:{src:s(951),alt:""}})])},function(){var t=this,e=t._self._c;return e("label",{attrs:{for:"avatar"}},[e("img",{staticClass:"icon-photo",attrs:{src:s(951),alt:""}})])}],o=(s(7658),s(8390)),n=s(3507),a=s(629),l=s(6163),c={props:{isShow:{type:Boolean},initUser:{type:Object,required:!0}},mixins:[n.Lf],data(){return{user:{},introduction:"",isProcessing:!1}},computed:{...(0,a.rn)(["currentUser","isAuthenticated"])},created(){this.fetchUser()},methods:{fetchUser(){this.user=this.initUser,this.introduction=this.currentUser.introduction,this.user={...this.user,introduction:this.introduction?this.introduction:""}},closeModal(){this.$emit("close-modal",!this.isShow),this.user.name=this.initUser.name,this.user.avatar=this.initUser.avatar,this.user.coverPhoto=this.initUser.coverPhoto,this.user.introduction=this.initUser.introduction||"type something here..."},back(){"user-follow"!==this.$route.name?this.$router.back():this.$router.push({name:"user-page",params:{id:this.currentUser.id}})},handleFileChange(t){const{files:e}=t.target;if(0!==e.length){const s=window.URL.createObjectURL(e[0]);"coverPhoto"===t.target.name?this.user.coverPhoto=s:"avatar"===t.target.name&&(this.user.avatar=s)}else this.image=""},async handleSubmit(t){try{if(0===this.user.name.length||0===this.user.introduction.length)return void l.F.fire({icon:"warning",title:"內容不可空白",background:"#FF6600",iconColor:"#fff",customClass:{container:"sweetalert2-warning-pop"}});if(this.user.name.length>50||this.user.introduction.length>160)return void l.F.fire({icon:"warning",title:"字數超過限制",background:"#FF6600",iconColor:"#fff",customClass:{container:"sweetalert2-warning-pop"}});this.isProcessing=!0;const e=t.target,s=new FormData(e),{data:r}=await o.Z.updateProfile(this.initUser.id,s);if("error"===r.status)throw new Error(r.message);this.closeModal(),this.$emit("refresh-user",this.user.id),this.isProcessing=!1}catch(e){this.isProcessing=!1,console.error(e),l.F.fire({icon:"error",title:"無法儲存變更，請稍後再試",background:"#FC5A5A",iconColor:"#fff",customClass:{container:"sweetalert2-error-pop"}})}},defaultCover(t){this.user.coverPhoto=t}},watch:{initUser(t,e){this.user={...this.user,...t}}}},u=c,d=s(1001),h=(0,d.Z)(u,r,i,!1,null,"7dd4d4a4",null),f=h.exports},4403:function(t,e,s){s.d(e,{Z:function(){return u}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-header d-flex align-item-center"},[e("div",{staticClass:"link-icon",on:{click:function(e){return e.preventDefault(),t.back.apply(null,arguments)}}}),e("div",{staticClass:"user-title d-flex justify-content-center"},[e("h5",{staticClass:"user-name"},[t._v(t._s(t.user.name))]),e("div",{staticClass:"user-tweetCounts number-wrap"},[t._v(t._s(t._f("quantifier")(t.user.tweetsLength)))])])])},i=[],o=(s(7658),s(629)),n={props:{user:{name:"",tweetsLength:""}},computed:{...(0,o.rn)(["currentUser","isAuthenticated"])},methods:{back(){"user-follow"!==this.$route.name?this.$router.back():this.$router.push({name:"user-page",params:{id:this.currentUser.id}})}},filters:{quantifier(t){return t+" 推文"}}},a=n,l=s(1001),c=(0,l.Z)(a,r,i,!1,null,"442ec7e0",null),u=c.exports},3349:function(t,e,s){s.r(e),s.d(e,{default:function(){return V}});s(7658);var r=function(){var t=this,e=t._self._c;return e("main",{staticClass:"main-view mx-auto"},[e("NavbarLeft"),t.isLoading?e("LoadingSpinner"):e("div",{staticClass:"user-page"},[e("UserHeader",{attrs:{user:t.user}}),e("div",{staticClass:"scroll"},[t.fullWidth<991?e("UserProfile",{attrs:{initUserId:t.user.id},on:{isEdit:t.dnoneTweet}}):t._e(),e("div",{staticClass:"follow-title"},[e("div",{staticClass:"user-followers",class:{active:"followers"===t.currentView},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.$router.push({path:`/user/follow/followers/${t.user.id}`})}}},[t._v("追蹤者")]),e("div",{staticClass:"user-followers",class:{active:"followings"===t.currentView},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.$router.push({path:`/user/follow/followings/${t.user.id}`})}}},[t._v("正在追隨")])]),e("div",{staticClass:"scroll follow",class:["scroll",{"d-none":!t.isShow}]},[e("UserFollowers",{directives:[{name:"show",rawName:"v-show",value:"followers"===t.currentView,expression:"currentView === 'followers'"}],attrs:{initFollowers:t.user.followers,initUserId:t.user.id}}),e("UserFollowings",{directives:[{name:"show",rawName:"v-show",value:"followings"===t.currentView,expression:"currentView === 'followings'"}],attrs:{"init-followings":t.user.followings,initUserId:t.user.id}})],1)],1)],1),e("SuggestUser",{on:{"refresh-follow":t.refreshFollowship}})],1)},i=[],o=s(9222),n=s(3814),a=s(629),l=s(3507),c=function(){var t=this,e=t._self._c;return e("div",t._l(t.followers,(function(s){return e("div",{key:s.id,staticClass:"comment_wrap d-flex"},[e("div",{staticClass:"avatar_image"},[e("router-link",{attrs:{to:{name:"user-page",params:{id:s.followerId}}}},[e("img",{attrs:{src:t._f("emptyImage")(s.avatar)}})])],1),e("div",{staticClass:"comment_wrap_body"},[e("div",{staticClass:"d-flex comment_wrap_body--title align-items-center"},[e("router-link",{attrs:{to:{name:"user-page",params:{id:s.followerId}}}},[e("h5",{staticClass:"size-16",staticStyle:{"line-height":"50px"}},[t._v(t._s(s.name))])]),e("button",{staticClass:"btn",class:{unfollow:!s.isFollowed},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleFollow(s)}}},[t._v(t._s(s.isFollowed?"正在跟隨":"跟隨"))])],1),s.introduction?e("div",{staticClass:"comment_wrap_body--content mb-3"},[t._v(t._s(s.introduction))]):t._e()])])})),0)},u=[],d=s(8390),h=s(1905),f=s(6163),w={props:{initFollowers:{type:Array,required:!0},initUserId:{type:Number,required:!0}},mixins:[l.Lf],data(){return{followers:[]}},computed:{...(0,a.rn)(["currentUser","isAuthenticated"])},created(){-1!==this.initUserId&&this.fetchData(this.initUserId)},watch:{initFollowers(){-1!==this.initUserId&&this.fetchData(this.initUserId)}},methods:{async fetchData(t){const{data:e}=await d.Z.getFollowers(t);this.followers=e},async toggleFollow(t){try{const e=t.followerId;if(!1===t.isFollowed){const{data:s}=await h.Z.addFollow(e);if("success"===s)throw new Error(s.message);f.F.fire({icon:"success",title:"成功追蹤"}),t.isFollowed=!t.isFollowed}else{const{data:t}=await h.Z.deleteFollow(e);if("success"===t)throw new Error(t.message);f.F.fire({icon:"success",title:"成功取消追蹤"})}}catch(e){console.log(e),f.F.fire({icon:"error",title:"追蹤失敗，請稍後再試"})}}}},p=w,g=s(1001),m=(0,g.Z)(p,c,u,!1,null,"2aeacc73",null),v=m.exports,C=function(){var t=this,e=t._self._c;return e("div",t._l(t.initFollowings,(function(s){return e("div",{key:s.followingId,staticClass:"comment_wrap d-flex"},[e("div",{staticClass:"avatar_image"},[e("router-link",{attrs:{to:{name:"user-page",params:{id:s.followingId}}}},[e("img",{attrs:{src:t._f("emptyImage")(s.avatar)}})])],1),e("div",{staticClass:"comment_wrap_body"},[e("div",{staticClass:"d-flex comment_wrap_body--title align-items-center"},[e("router-link",{attrs:{to:{name:"user-page",params:{id:s.followingId}}}},[e("h5",{staticClass:"size-16",staticStyle:{"line-height":"50px"}},[t._v(t._s(s.name))])]),s.isFollowed?e("button",{staticClass:"btn",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteFollowing(s.followingId)}}},[t._v("正在跟隨")]):e("button",{staticClass:"btn unfollow",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addFollowing(s.followingId)}}},[t._v("跟隨")])],1),s.introduction?e("div",{staticClass:"comment_wrap_body--content mb-3"},[t._v(t._s(s.introduction))]):t._e()])])})),0)},_=[],F={props:{initFollowings:{type:Array,required:!0}},mixins:[l.Lf],data(){return{followings:[],isFollowed:!0}},created(){this.fetchData()},computed:{...(0,a.rn)(["currentUser"])},methods:{fetchData(){this.followings=this.initFollowings},async deleteFollowing(t){try{const{data:e}=await h.Z.deleteFollow({userId:t});if("error"===e.status)throw new Error(e.message);this.followings.filter((e=>{if(t===e.followingId)return e.isFollowed=!1}))}catch(e){console.log(e),f.F.fire({icon:"error",title:"取消追蹤失敗，請稍後再試"})}},async addFollowing(t){try{console.log(t);const{data:e}=await h.Z.addFollow(t);if("error"===e)throw new Error(e.message);this.followings.filter((e=>{t===e.followingId&&(e.isFollowed=!0)}))}catch(e){console.error(e),f.F.fire({icon:"error",title:"無法加入追蹤，請稍後再試",background:"#FC5A5A",iconColor:"#fff",customClass:{container:"sweetalert2-error-pop"}})}}},watch:{initFollowings:function(){this.fetchData()}}},U=F,b=(0,g.Z)(U,C,_,!1,null,"5ff55fdf",null),A=b.exports,y=s(4403),P=function(){var t=this,e=t._self._c;return e("div",[e("UserEdit",{attrs:{"is-show":t.isShow,initUser:t.user},on:{"close-modal":t.closeModal,"refresh-user":t.refreshUser}}),e("div",{staticClass:"user-profile"},[e("div",{staticClass:"user-banner"},[e("img",{attrs:{src:t._f("emptyBanner")(t.user.coverPhoto),alt:""}})]),e("div",{staticClass:"avatar"},[e("img",{attrs:{src:t._f("emptyImage")(t.user.avatar),alt:""}})]),e("div",{staticClass:"d-flex justify-content-end btn-wrap"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.user.id!==t.currentUser.id,expression:"user.id !== currentUser.id"}],staticClass:"btn email"},[e("a",{attrs:{href:`mailto:${t.user.email}`}})]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.user.id!==t.currentUser.id,expression:"user.id !== currentUser.id"}],staticClass:"btn notify"}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.user.id===t.currentUser.id,expression:"user.id === currentUser.id"}],staticClass:"user-setting",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.openModal.apply(null,arguments)}}},[t._v("編輯個人資料")]),t.user.id===t.currentUser.id||t.user.isFollowed?t._e():e("div",{staticClass:"btn unfollow",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addFollow(t.user.id)}}},[t._v("追蹤")]),t.user.id!==t.currentUser.id&&t.user.isFollowed?e("div",{staticClass:"btn",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteFollow(t.user.id)}}},[t._v("正在追蹤")]):t._e()]),e("div",{staticClass:"user-info"},[e("h5",[t._v(t._s(t.user.name))]),e("div",{staticClass:"user-account number-wrap"},[t._v(t._s(t._f("account")(t.user.account)))]),e("div",{staticClass:"user-decription number-wrap"},[t._v(t._s(t.user.introduction))]),e("div",{staticClass:"user-follow d-flex number-wrap"},[e("div",{staticClass:"user-info-following",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toFollowPage("followings")}}},[e("span",[t._v(t._s(t.user.followingCount))]),t._v(" 個跟隨中 ")]),e("div",{staticClass:"user-info-follower",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toFollowPage("followers")}}},[e("span",[t._v(t._s(t.user.followerCount))]),t._v(" 位跟隨者 ")])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:"user-page"===this.$route.name,expression:"this.$route.name === 'user-page'"}],staticClass:"togglePage d-flex"},[e("div",{staticClass:"userTweets",class:{active:"userTweets"===t.currentContent},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.togglePage("userTweets")}}},[t._v("推文")]),e("div",{staticClass:"userTweets",class:{active:"userReplies"===t.currentContent},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.togglePage("userReplies")}}},[t._v("回覆")]),e("div",{staticClass:"userTweets",class:{active:"userLikes"===t.currentContent},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.togglePage("userLikes")}}},[t._v("喜歡的內容")])])])],1)},k=[],x=s(2895),I={name:"userProfile",components:{UserEdit:x.Z},props:{initUserId:{type:Number}},mixins:[l.Lf,l.$2],data(){return{user:{id:-1,account:"",email:"",name:"",password:"",role:"",avatar:"",coverPhoto:"",introduction:"",followerCount:0,followingCount:0,tweetsLength:0,isFollowed:!1},currentContent:"userTweets",isShow:!1,isLoading:!1}},created(){this.fetchUser(this.initUserId)},computed:{...(0,a.rn)(["currentUser"])},watch:{initUserId(){this.fetchUser(this.initUserId)}},methods:{async fetchUser(t){this.isLoading=!0;const{data:e}=await d.Z.getUser(t),{id:s,account:r,name:i,email:o,avatar:n,coverPhoto:a,introduction:l,followerCount:c,followingCount:u,Tweets:h,isFollowed:f}=e;this.user={...this.user,id:s,account:r,name:i,email:o,avatar:n,coverPhoto:a,introduction:l,followerCount:c,followingCount:u,tweetsLength:h?h.length:0,isFollowed:f},this.isLoading=!1},togglePage(t){this.currentContent=t},openModal(){return this.$emit("isEdit",this.isShow),this.isShow=!0},closeModal(t){return this.$emit("isEdit",this.isShow),this.isShow=t},async addFollow(t){try{const{data:e}=await h.Z.addFollow(t);if("error"===e.status)throw new Error(e.message);this.user.isFollowed=!0}catch(e){console.error(e),f.F.fire({icon:"warning",title:"無法加入追蹤，請稍後再試"})}},async deleteFollow(t){try{const{data:e}=await h.Z.deleteFollow({userId:t});if("error"===e.status)throw new Error(e.message);this.user.isFollowed=!1}catch(e){console.error(e),f.F.fire({icon:"warning",title:"無法移除追蹤，請稍後再試"})}},refreshUser(t){this.fetchUser(t)},toFollowPage(t){"user-follow"!==this.$route.name&&this.$router.push({path:`/user/follow/${t}/${this.user.id}`})}},filters:{quantifier(t){return t+" 推文"}}},L=I,S=(0,g.Z)(L,P,k,!1,null,"336a7402",null),D=S.exports,Z=s(4409),$={name:"userFollow",components:{NavbarLeft:o.Z,SuggestUser:n.Z,UserFollowers:v,UserFollowings:A,UserHeader:y.Z,UserProfile:D,LoadingSpinner:Z.Z},mixins:[l.Lf,l.$2],data(){return{user:{id:-1,name:"",tweetsLength:0,followers:[],followings:[]},isShow:!1,currentView:"",fullWidth:0,isLoading:!1}},created(){const{id:t}=this.$route.params,e=this.$route.params.user;this.currentView=t,this.fetchFollow(e),this.fetchFollowing(e)},computed:{...(0,a.rn)(["currentUser"])},beforeRouteUpdate(t,e,s){const{id:r}=t.params,i=t.params.user;this.currentView=r,this.fetchFollow(i),this.fetchFollowing(i),s()},methods:{async fetchFollow(t){try{this.isLoading=!0;const{data:e}=await d.Z.getUser(t),{id:s,name:r,Tweets:i,Followers:o,isFollowed:n}=e;this.user={...this.user,id:s,name:r,tweetsLength:i.length,followers:o,isFollowed:n},this.isLoading=!1}catch(e){console.log(e)}},async fetchFollowing(t){try{this.isLoading=!0;const{data:e}=await d.Z.getFollowings(t);if("error"===e.status)throw new Error(e.message);this.user.followings=e,this.isLoading=!1}catch(e){console.log(e)}},openModal(){return this.isShow=!0},closeModal(t){return this.isShow=t},toggleContent(t){this.currentView=t},refreshFollowship(t){this.fetchFollowing(t)},dnoneTweet(t){this.isShow=t}},mounted(){this.fullWidth=window.innerWidth,window.onresize=()=>{this.fullWidth=window.innerWidth}},filters:{quantifier(t){return t+" 推文"}}},N=$,E=(0,g.Z)(N,r,i,!1,null,"5737904b",null),V=E.exports},951:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFBSURBVHgB3ZVhccMwDIWV3QAUQsZgEBYEhZAxWBi0Q7AOwVIGY5AOQcvAYbAx0J7OcqtLUzuN//T63b1z7MiyJSsO0d3DzAtoBe35hDy/QSXlAAfP0K867aANtNZnwYkNzUF2p85Hneh7pzbpRXRCp5OccV4m5lhbpz6OcwpjvEezgHbGx7Yoih3FN/aCpjZD0u8xrxoaCmvKRM+IQ/9h4iRJxYdWj+iLr62gSxFgrDaVNKTOikB32ZI/G+FTFWhTkaRStBr0v1WWhjIWCPUtu5aqOKgqOkWyzFkgpIZH3oWxP4rwSHF+oJJ8GkShtjtjc4g5SEXQDvpLOk/JO00hUqYNX6YZsb/uQ8Mnv0HzBG3Jp6MnH1ml76KkziAs0qN5pRlMuipysBFI+LVJ31zk+ujPRtn/vRznI5fhvL/cTfIPBN+KksncOFcAAAAASUVORK5CYII="}}]);
//# sourceMappingURL=349.106166d6.js.map